zDoc工作目录约定
=====


### 顶级目录结构
	
zDoc 假想你的工作目录由如下结构组成

	[imgs]       # 存放你所有的图片文件，zDoc 会全部 copy 到目标目录
	[js]         # 存放你所有的脚本文件，zDoc 会全部 copy 到目标目录
	[css]        # 存放你所有的样式表单，zDoc 会全部 copy 到目标目录
	[_tmpl]      # 这里存放模板，一个网站可以有多个模板
	[_libs]      # 这里存放代码片段
	zdoc.conf    # 你的网站项目的总体配置文件
	index.xml    # 【选】你的文档索引的顺序
	index.html   # 所有的 HTML,markdown,zDoc 文件都会一视同仁进行转换
	readme.md     
	aboutus.zdoc
	
#### _tmpl 目录
	
	[_tmpl]                 # 目录内任何一个 html 文件就是一个模板
		normal.html         # 这个模板的名字为 "normal"
		[black]             
			myblank.html    # 这个模板的名字为 "black.myblank"
			
* 一个模板文件可以是 `.html`,`.md`,`.zdoc`,`.txt` 任何一个扩展名
* 模板文件中，可以声明 `${-main-}`，用作占位符


#### _libs 目录
	
	[_libs]                 # 目录内任何一个 html 文件就是一个代码片段
		menu.html           # 这个片段的名字为 "menu"
		[black]             
			menu.html       # 这个片段的名字为 "black.menu"

* lib 文件可以以是 `.html`,`.md`,`.zdoc`,`.txt` 任何一个扩展名
* `.html` 被展开时，会被替换其内的链接（图片和超链接）
* `.md`和`.zdoc` 被展开时，会被解析，然后遍历内部链接，替换成相对宿主正确的链接
* `.txt` 被展开时，会直接将全部内容替换进去

			
#### zdoc.conf

放置这个文件的的目录将作为 zdoc 的工作目录，这个文件也不是必须的，如果没有，一切将采用
默认值

	#-----------------------------------------------------------
	# 模板目录，默认 _tmpl
	zdoc-tmpl=_tmpl
	#-----------------------------------------------------------
	# 代码片段目录，默认 _libs
	zdoc-libs=_libs
	#-----------------------------------------------------------
	# 下面的路径，都是要全部执行 copy 的
	zdoc-rs=imgs,js,css
	#-----------------------------------------------------------
	# 网页的模板设置
	#
	#  > 每行两个字段 :  [网页路径匹配模式(正则表达式)]  : 模板名
	#  > 排在第一行的匹配规则有更高的优先级
	#
	# 如果没有这个设置，默认相当于
	#
	#   .*           : none
	#
	# 关键字 "none" 表示不使用任何模板，比如:
	#
	#   /abc.html     : none
	#
	zdoc-rules:
	/index.html  : normal
	/page/.*     : black.myblank
	.*           : noneor
	# ~ 结束模板设置
	#-----------------------------------------------------------
	# 你可以声明一组变量，在文档中通过占位符使用它们，这样你就能声明自己的术语表
	zdoc-vars:
	Nutz=[http://nutzam.com Nutz]
	# ~ 结束变量声明
	
## 所谓转换

所谓 zdoc 的转换，就是寻找工作目录中任何 `.zdoc|.md|.htm` 对其进行转换。
一次转换将执行下列动作

1. 寻找一个匹配的网页模板
	* 如果文档的元数据中有声明 `tmpl=xxxx` 就用这个模板，否则用 `zdoc-rules` 的规则来寻找模板
	* 根据网页的当前路径，修改模板中的 src, href
2. 将当前网页内容嵌入模板
3. 将网页和模板中应用的代码片段链入
	* 根据网页的当前路径，修改文档中的图片 src, href
	
	
